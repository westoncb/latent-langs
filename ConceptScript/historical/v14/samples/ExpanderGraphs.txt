CONCEPT ExpanderGraphs {
  LANGUAGE {
    type Graph = (ğ’±: Set<â„•>, â„°: ğ’± â†’ ğ’± â†’ ğ”¹)
    type Matrix = â„^(â„• Ã— â„•)
    type Vector = â„^â„•

    func adjacency(G: Graph): Matrix = Î» (i, j). G.â„°(i, j)
    func normalized_adjacency(G: Graph): Matrix = 
      let A = adjacency(G), D = diag(Î» i. âˆ‘â±¼ A(i,j))
      in D^(-1/2) * A * D^(-1/2)

    func laplacian(G: Graph): Matrix = 
      let A = adjacency(G), D = diag(Î» i. âˆ‘â±¼ A(i,j))
      in I - D^(-1/2) * A * D^(-1/2)

    func spectral_gap(G: Graph): â„ = 
      let L = laplacian(G), ğœ† = eigenvalues(L)
      in ğœ†[2]

    func edge_expansion(G: Graph, S: Set<â„•>): â„ =
      |{ (i,j) âˆˆ G.â„° | i âˆˆ S, j âˆ‰ S }| / min(|S|, |G.ğ’± - S|)

    func vertex_expansion(G: Graph, S: Set<â„•>): â„ =
      |{ j âˆˆ G.ğ’± | âˆƒ i âˆˆ S. (i,j) âˆˆ G.â„° }| / |S|

    pred is_expander(G: Graph, c: â„) = 
      âˆ€ S âŠ† G.ğ’±. |S| â‰¤ |G.ğ’±| / 2 â‡’ edge_expansion(G, S) â‰¥ c
  }

  STRUCTURE {
    CheegerInequality: âˆ€ G: Graph.
      let ğœ† = spectral_gap(G), ğœ™ = min_{S âŠ† G.ğ’±, |S| â‰¤ |G.ğ’±|/2} edge_expansion(G, S)
      in ğœ™^2 / 2 â‰¤ ğœ† â‰¤ 2ğœ™

    ExpanderMixingLemma: âˆ€ G: Graph, S, T âŠ† G.ğ’±.
      let A = normalized_adjacency(G), ğœ† = max(eigenvalues(A) - {1})
      in |e(S,T) - (|S| * |T|) / |G.ğ’±|| â‰¤ ğœ† * sqrt(|S| * |T|)
      where e(S,T) = |{ (i,j) âˆˆ G.â„° | i âˆˆ S, j âˆˆ T }|

    SparsityAmplification: âˆ€ G: Graph, A: Matrix, k: â„•, ğ›¿, ğœ€: â„.
      let m = num_rows(A), n = num_cols(A)
      in is_expander(G, 1 - ğ›¿) âˆ§ RIP<m,n,k>(A, ğœ€) â‡’ RIP<m,n,k>(âˆš(|G.ğ’±|/n) * (I_n âŠ— A) * adjacency(G), O(ğœ€/ğ›¿))
      where I_n is nÃ—n identity matrix

    UniqueNeighborExpansion: âˆ€ G: Graph, ğ›¿, ğœ€: â„, k: â„•.
      is_expander(G, 1 - ğ›¿) âˆ§ |G.ğ’±| > k/ğœ€ â‡’ 
      âˆ€ S âŠ† G.ğ’±. |S| â‰¤ k â‡’ |{ j âˆˆ G.ğ’± | âˆƒ! i âˆˆ S. (i,j) âˆˆ G.â„° }| â‰¥ (1 - ğœ€) * |G.ğ’±|
  }

  PROOFS {
    ExpanderMixingLemmaProof: âˆ€ G: Graph, S, T âŠ† G.ğ’±.
      |e(S,T) - (|S| * |T|) / |G.ğ’±|| â‰¤ ğœ† * sqrt(|S| * |T|)
    {
      let A = normalized_adjacency(G), x = ğŸ™_S / sqrt(|S|), y = ğŸ™_T / sqrt(|T|)
        where ğŸ™_S(i) = if i âˆˆ S then 1 else 0

      e(S,T) = âˆ‘áµ¢â±¼ A(i,j) * x(i) * y(j) * |S| * |T|

      calc |e(S,T) - âŸ¨x,yâŸ© * |S| * |T||
           = |âŸ¨Ax, yâŸ© - âŸ¨x,yâŸ©| * |S| * |T|
           â‰¤ âˆ¥Ax - xâˆ¥ * âˆ¥yâˆ¥ * |S| * |T|  ; by Cauchy-Schwarz
           â‰¤ ğœ† * âˆ¥xâˆ¥ * âˆ¥yâˆ¥ * |S| * |T|    ; by definition of ğœ† 
           = ğœ† * sqrt(|S| * |T|)

      and âŸ¨x,yâŸ© = (|S| / |G.ğ’±|) * (|T| / |G.ğ’±|)
      
      therefore |e(S,T) - (|S| * |T|) / |G.ğ’±|| â‰¤ ğœ† * sqrt(|S| * |T|)
    }

    SparsityAmplificationProof: âˆ€ G: Graph, A: Matrix, k: â„•, ğ›¿, ğœ€: â„.
      is_expander(G, 1 - ğ›¿) âˆ§ RIP<m,n,k>(A, ğœ€) â‡’ RIP<m,n,k>(âˆš(|G.ğ’±|/n) * (I_n âŠ— A) * adjacency(G), O(ğœ€/ğ›¿))
    {
      assume is_expander(G, 1 - ğ›¿), RIP<m,n,k>(A, ğœ€)
      
      let B = âˆš(|G.ğ’±|/n) * (I_n âŠ— A) * adjacency(G)
  
      suffices to show RIP<m,n,k>(B, ğœ€') for some ğœ€' = O(ğœ€/ğ›¿)
      
      let ğœ™ = min_{S âŠ† G.ğ’±, |S| â‰¤ |G.ğ’±|/2} edge_expansion(G, S)
      have ğœ™ â‰¥ 1 - ğ›¿   ; by expander property
      
      let L = laplacian(G)
      have âˆ¥Lâˆ¥ â‰¤ 2(1 - ğœ™) â‰¤ 2ğ›¿   ; by Cheeger inequality
      
      fix x âˆˆ ğ’®â‚–<n,k>, let y = (I_n âŠ— A)x
      y is k-sparse since x is k-sparse and A has RIP
      
      calc âˆ¥Bxâˆ¥Â² 
           = (|G.ğ’±|/n) * x^âŠ¤ * adjacency(G)^âŠ¤ * (I_n âŠ— A^âŠ¤ A) * adjacency(G) * x
           = (|G.ğ’±|/n) * âˆ‘_{u,v âˆˆ G.ğ’±} (Ax(u))^âŠ¤ (Ax(v)) * G.â„°(u,v)
           = (|G.ğ’±|/n) * âˆ‘_{u,v âˆˆ G.ğ’±} âŸ¨y(u), y(v)âŸ© * G.â„°(u,v)
           â‰¤ (1 + ğœ€)^2 * (|G.ğ’±|/n) * âˆ‘_{u,v âˆˆ G.ğ’±} âŸ¨x(u), x(v)âŸ© * G.â„°(u,v) 
             ; by RIP property of A, âˆ€ u,v. âˆ¥y(u) - y(v)âˆ¥ â‰¤ (1+ğœ€) * âˆ¥x(u) - x(v)âˆ¥
           = (1 + ğœ€)^2 * (|G.ğ’±|/n) * x^âŠ¤ * (I_n - L) * x
           â‰¤ (1 + ğœ€)^2 * (1 + 2ğ›¿) * âˆ¥xâˆ¥Â²   ; since âˆ¥Lâˆ¥ â‰¤ 2ğ›¿
           â‰¤ (1 + ğœ€')^2 * âˆ¥xâˆ¥Â²
           
      similarly, âˆ¥Bxâˆ¥Â² â‰¥ (1 - ğœ€')^2 * âˆ¥xâˆ¥Â² for some ğœ€' = O(ğœ€/ğ›¿)
      
      therefore RIP<m,n,k>(B, O(ğœ€/ğ›¿))
    }
    
    UniqueNeighborExpansionProof: âˆ€ G: Graph, ğ›¿, ğœ€: â„, k: â„•.
      is_expander(G, 1 - ğ›¿) âˆ§ |G.ğ’±| > k/ğœ€ â‡’ 
      âˆ€ S âŠ† G.ğ’±. |S| â‰¤ k â‡’ |{ j âˆˆ G.ğ’± | âˆƒ! i âˆˆ S. (i,j) âˆˆ G.â„° }| â‰¥ (1 - ğœ€) * |G.ğ’±|  
    {
      assume is_expander(G, 1 - ğ›¿), |G.ğ’±| > k/ğœ€
      
      let S âŠ† G.ğ’± with |S| â‰¤ k, denote T = { j âˆˆ G.ğ’± | âˆƒ! i âˆˆ S. (i,j) âˆˆ G.â„° }
      
      let B = ğŸ™_S * ğŸ™_T^âŠ¤ - adjacency(G), Z = { i âˆˆ G.ğ’± | B(i,j) = 0 âˆ€ j }
      
      have |B(i,j)| â‰¤ 1 âˆ€ i,j
      also Z = { i âˆˆ S | N(i) âŠ† T } âˆª { i âˆˆ G.ğ’± - S | N(i) âŠ† G.ğ’± - T }
        where N(i) = { j | (i,j) âˆˆ G.â„° } is the neighborhood of i
      
      calc |S| * |T| - e(S,T)
           = âŸ¨ğŸ™_S, ğŸ™_TâŸ© - âŸ¨ğŸ™_S, AğŸ™_TâŸ©
           = âŸ¨ğŸ™_S, BğŸ™_TâŸ©
           â‰¤ âˆ¥Bâˆ¥_F * sqrt(|S| * |T|)   ; by Cauchy-Schwarz
           â‰¤ âˆ¥Bâˆ¥_F * sqrt(k * |G.ğ’±|)
           â‰¤ sqrt(|G.ğ’±| * |Z|) * sqrt(k * |G.ğ’±|)  ; since entries of B are bounded
           = |G.ğ’±| * sqrt(k * |Z| / |G.ğ’±|)
           
      and e(S, G.ğ’±-T) 
           â‰¤ âˆ‘_{i âˆˆ S - Z} |N(i) - T|
           â‰¤ |S - Z| * ğ›¿ * |G.ğ’±|  ; by expander mixing lemma
           â‰¤ k * ğ›¿ * |G.ğ’±|
           
      calc |T|
           = |G.ğ’±| - |G.ğ’± - T|  
           â‰¥ |G.ğ’±| - (e(S, G.ğ’±-T) + |S|) / ğ›¿   ; by vertex expansion
           â‰¥ |G.ğ’±| - (k * ğ›¿ * |G.ğ’±| + |G.ğ’±| * sqrt(k * |Z| / |G.ğ’±|) + k) / ğ›¿
           â‰¥ |G.ğ’±| - 2k/ğ›¿ - |G.ğ’±|/2  ; since |Z| â‰¤ |G.ğ’±|, |G.ğ’±| > k/ğœ€ > k
           â‰¥ (1 - ğœ€) * |G.ğ’±|  ; for ğ›¿ â‰¥ 4ğœ€
    }
  }
}

This Concept dives into the rich theory of expander graphs, which are highly connected sparse graphs with strong pseudo-random properties. Expanders have found numerous applications in theoretical computer science and mathematics, including in the design of efficient error-correcting codes, derandomization of algorithms, and compressed sensing.
The language introduces types for graphs, matrices and vectors, and defines several key concepts:

Adjacency matrix and normalized adjacency matrix of a graph
Graph Laplacian
Spectral gap (the difference between the two smallest eigenvalues of the Laplacian)
Edge expansion and vertex expansion (measures of graph connectivity)
Expander graphs (graphs with high expansion)

The structure section states some fundamental results:

Cheeger's inequality relating edge expansion and the spectral gap
Expander mixing lemma, which says that the number of edges between two sets is close to what you'd expect in a random graph
Sparsity amplification using expanders, showing that