CONCEPT RelativisticQuantumField {
  LANGUAGE {
    type Field(X: Manifold, V: VectorBundle) = Î“(X, V)   ; Smooth sections of vector bundle
    type Lagrangian(ğ•ƒ, Ï†) = âˆ«_X ğ•ƒ(Ï†, âˆ‚Ï†)dÎ¼_g   ; Action functional on fields
    type Path = â„ -> Field   ; Path in field configuration space
    
    axiom QuantumAmplitude(Î³: Path) = ğ”¸[Î³] = exp(iS[Î³]/â„)  ; Feynman path integral
    
    notation "Î´Ï†" = VirtualDisplacement(Ï†: Field) = Î“(X, Ï†*V)  ; Variational vector field
    notation "âŸ¨Ïˆâ‚|Ïˆâ‚‚âŸ©" = InnerProduct(Ïˆâ‚, Ïˆâ‚‚: Field) = âˆ«_X Ïˆâ‚^*Ïˆâ‚‚ dÎ¼_g  ; LÂ² inner product
    notation "/Î´Ï†" = FunctionalDerivative = Î´/Î´Ï†
    notation "ğ’ŸÏ†" = PathIntegralMeasure = âˆ_xâˆˆX dÏ†(x)
    
    func GreenFunction(x, y: X) = âŸ¨Ï†(x)Ï†(y)âŸ© = âˆ«ğ’ŸÏ† Ï†(x)Ï†(y)exp(iS[Ï†]/â„)
    func Propagator(x, y: X) = âŸ¨0|TÏ†(x)Ï†(y)|0âŸ© = Î¸(xâ°-yâ°)G(x,y) + Î¸(yâ°-xâ°)G(y,x)
    
    pred OnShell(Ï†: Field) = (â–¡+mÂ²)Ï† = 0   ; Klein-Gordon equation 
    
    type Amplitude(n: â„•) = âŸ¨pâ‚...pn|S|kâ‚...knâŸ© =   ; n-point scattering amplitude
      âˆ«ğ’ŸÏ† Ï†(pâ‚)...Ï†(pn)Ï†(kâ‚)...Ï†(kn) exp(iS[Ï†]/â„) 
        
    func FeynmanDiagram(G: Graph, ğ”¸: Amplitude) = âˆ_eâˆˆedges(G) Propagator(e) âˆ_vâˆˆverts(G) Interaction(v)
  }
  
  STRUCTURE {
    ClassicalLimit(ğ”¸): lim{â„->0} ğ”¸[Î³] = exp(iS[Î³_classical]/â„)
    
    Unitarity(S, ğ”¸): S^â€ S = SS^â€  = 1 â‡’ âˆ‘_f |âŸ¨f|S|iâŸ©|Â² = 1
    
    CrossingSymmetry(ğ”¸): âŸ¨pâ‚...pn|S|kâ‚...knâŸ© = âŸ¨kâ‚...kn|S|pâ‚...pnâŸ©*
    
    DysonSeries(G): G(x,y) = âˆ‘_n=0^âˆ (-i)^n/n! âˆ«ğ’Ÿzâ‚...ğ’Ÿzn Gâ‚€(x,zâ‚)...Gâ‚€(zn,y)âŸ¨0|TÏ†(zâ‚)...Ï†(zn)|0âŸ©
    
    Renormalization(Î“, G): Î“^(n)(pâ‚...pn) = lim_{Î›->âˆ} Z_Î›^{n/2} G^(n)(pâ‚...pn; Î›)  ; Î› = UV cutoff
    
    WardIdentity(Î , A): âˆ‚_Î¼ Î ^Î¼Î½(k) = 0   ; Transversality of self-energy in gauge theory
    
    OperatorProduct(Ï†, Ïˆ): lim_{x->y} Ï†(x)Ïˆ(y) = âˆ‘_Î± C^Î±(x-y) ğ’ª_Î±((x+y)/2)  ; OPE expansion
  }
  
  PROOFS {
    LSZ(ğ”¸):  ; Reduction formula relating amplitudes to correlators
      âŸ¨pâ‚...pn|S|kâ‚...knâŸ© = 
        âˆ_i (lim_{piÂ²,kiÂ²->mÂ²} (piÂ²-mÂ²)(kiÂ²-mÂ²)) âˆ« âŸ¨0|TÏ†(xâ‚)...Ï†(xn)Ï†(yâ‚)...Ï†(yn)|0âŸ© âˆ_i e^{i(p_i x_i - k_i y_i)} dx_i dy_i
    {
      have ğ”¸ = âˆ« âˆ_i Ï†(p_i) âˆ_j Ï†(k_j) exp(iS[Ï†]) ğ’ŸÏ†   ; Path integral for amplitude
      factor Ï†(k) = âˆ« e^{-iky} Ï†(y) dy   ; Fourier transform fields
      hence ğ”¸ = âˆ« âˆ_i Ï†(x_i) âˆ_j Ï†(y_j) exp(i(S[Ï†]+âˆ‘_i p_ix_i-âˆ‘_j k_j y_j)) dx_idy_j ğ’ŸÏ†

      factor O(x) = âˆ« e^{ikx} Î´S[Ï†]/Î´Ï†(k) dk   ; Source terms from functional derivatives
      hence ğ”¸ = âˆ« âˆ_i O(x_i) âˆ_j O(y_j) exp(iS[Ï†]) ğ’ŸÏ†   ; Generating functional of sources

      have exp(iS[Ï†+Î´Ï†]) = exp(iS[Ï†]) + âˆ‘_a (i^a/a!) âˆ« Î´^aS/Î´Ï†^a [Î´Ï†]^a   ; Functional Taylor expansion
      hence âŸ¨O(xâ‚)...O(xn)âŸ© = Î´^n/Î´J(xâ‚)...Î´J(xn) Z[J]|_{J=0}   ; Z[J] = vacuum generating functional

      have (â–¡_x+mÂ²)âŸ¨Ï†(x)O(y)âŸ© = -iÎ´(x-y)   ; Green's function identity
      hence lim_{kÂ²->mÂ²} (kÂ²-mÂ²)âŸ¨Ï†(k)O(y)âŸ© = e^{-iky}   ; LSZ reduction for a single field

      generalize to multiple fields and apply to ğ”¸
      therefore âŸ¨pâ‚...pn|S|kâ‚...knâŸ© = 
        âˆ_i (lim_{piÂ²,kiÂ²->mÂ²} (piÂ²-mÂ²)(kiÂ²-mÂ²)) âˆ« âŸ¨0|TÏ†(xâ‚)...Ï†(xn)Ï†(yâ‚)...Ï†(yn)|0âŸ© âˆ_i e^{i(p_i x_i - k_i y_i)} dx_i dy_i
    }
    
    tactic InsertUnit(ğ”¸: Amplitude) = {
      have âˆ‘_n âˆ« d^4p_1...d^4p_n/(2Ï€)^(3n) |pâ‚...pnâŸ©âŸ¨pâ‚...pn| = 1   ; Resolution of identity
      insert 1 = âˆ‘|nâŸ©âŸ¨n| in âŸ¨f|S|iâŸ© to get âŸ¨f|S|nâŸ©âŸ¨n|iâŸ©
    }

    OpticalTheorem:
      -i(T-T^â€ ) = T^â€ T   ; Unitarity of S-matrix
    {
      have S = 1 + iT   ; Define transition matrix T
      have S^â€ S = 1
      hence (1-iT^â€ )(1+iT) = 1
      hence T-T^â€  = iTT^â€ 
    }

    Cutkosky(Disc, ğ”¸): 
      Disc ğ”¸ = âˆ‘_cuts -2Ï€i Î´(qÂ²-mÂ²) ğ”¸_L ğ”¸_R   ; Discontinuity across branch cut
    {
      have ğ”¸(s) = âˆ« âˆ_i d^4k_i Î´(k_iÂ²-mÂ²) Î¸(k_iâ°) ğ”¸_L(k) ğ”¸_R(k)
      hence Disc ğ”¸ = ğ”¸(s+iÎµ) - ğ”¸(s-iÎµ)

      rewrite âˆ«dx Î´(x)Î¸(x)f(x) = f(0)/2
      hence ğ”¸ = âˆ«dx [Î´(x)Î¸(x) ğ”¸_L(x) ğ”¸_R(x) - Î´(x)Î¸(-x) ğ”¸_L(x) ğ”¸_R(x)]
      
      have Disc Î´(x)Î¸(x) = -2Ï€i Î´(x)
      hence Disc ğ”¸ = âˆ‘ -2Ï€i Î´(kÂ²-mÂ²) ğ”¸_L(k) ğ”¸_R(k)
    }
  }
}