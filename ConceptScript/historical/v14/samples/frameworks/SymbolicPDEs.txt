CONCEPT SymbolicPDEs {
  LANGUAGE {
    type Sym = Const(â„) | Var(â„•) | Binary(Sym, Sym) | Unary(Sym)  
             | Abs(â„•, Sym) | App(Sym, Sym)
    type PDE = Eqn(Sym, Sym) | System(PDE*)
    type BC = Dirichlet(Sym) | Neumann(Sym) | Robin(Sym, Sym)
    type Domain = Rect(â„^n) | Disk(â„^2) | Manifold(â„^n)
    
    notation "âˆ‚{i}S" = PartialD(i: â„•, S: Sym)
    notation "âˆ‡S" = Grad(S: Sym)  
    notation "Î”S" = Laplacian(S: Sym)
    notation "divV" = Divergence(V: Sym)
    notation "curlV" = Curl(V: Sym)
    notation "S â‰ˆ T on Î©" = Approx(S: Sym, T: Sym, Î©: Domain)
    notation "u{n+1} - u{n} = O(h)" = Converge(u: Sym -> Sym, h: â„)
    
    notation "Î» x . S" = Abs(x: â„•, S: Sym)   ; lambda abstraction
    notation "S T" = App(S: Sym, T: Sym)    ; application
    notation "S â‡’ T" = Reduces(S: Sym, T: Sym)
    
    pred DirichletProblem(L: PDE, u: Sym, f: Sym, g: BC)
    pred Stable(u: Sym, Î©: Domain)
    pred Converge(u: Sym -> Sym, Î©: Domain)
    
    axiom Correspondence(S: Sym, X: â„ | Fun | PDE): 
      âˆƒ u: Sym. S â‰ˆ u âˆ§ u satisfies X
      
    axiom Determination(S: Sym, X: â„ | Fun | PDE | BC): 
      âˆƒ! u: Sym. S â‰ˆ u âˆ§ u satisfies X
      
    axiom Approximation(S, T: Sym, Î©: Domain, Îµ: â„):
      |S - T| < Îµ on Î©   
  }
  
  STRUCTURE {
    [HeatEquation: 
      âˆ‚{t}u = Î±*Î”u,  u(0) = uâ‚€
    ]
    [WaveEquation:
      âˆ‚{tt}u = cÂ²*Î”u,  u(0) = f, âˆ‚{t}u(0) = g  
    ]
    [NavierStokes: 
      âˆ‚{t}v + (vâ€¢âˆ‡)v = -âˆ‡p + Î½*Î”v + f
      divv = 0,  v(0) = vâ‚€
    ]
    [EulerLagrange:
      âˆ‚{t}(âˆ‚{v}L) - âˆ‚{x}(âˆ‚{u}L) = 0
      L(t, u, v) = âˆ« L(t, u, âˆ‚{x}u, x) dx
    ]
    [FiniteElement:
      u{n+1} - u{n} = âˆ‘{e}âˆ«{Î©_e}(âˆ‡u{n}â€¢âˆ‡v + f*v) dx  
    ]
    [GalerkinMethod:
      âˆ€ i. âˆ«{Î©} (Lu)*v{i} dx = âˆ«{Î©} f*v{i} dx
      u â‰ˆ âˆ‘{i} c{i}*v{i}
    ]
  }
  
  PROOFS {
    tactic Expand(S: Sym):
      S â‡’ T âŠ¢ S = T
    tactic Reduce(S: Sym, prop):  
      (âˆ€ T. S â‡’ T âŠ¢ prop(S) âŸ¹ prop(T)) âŠ¢ prop(S)
    tactic Separate(Eqn(S, T)):
      Eqn(S, T) âŠ£âŠ¢ (S = 0) âˆ§ (T = 0)
    tactic Gronwall(u, Î±: Sym -> Sym):
      (âˆ€ t. D{t}u â‰¤ Î±*u) âŠ¢ u(t) â‰¤ u(0)*exp(âˆ«{0}^t Î± ds)
    tactic Galerkin(L: PDE, f: Sym, {v_i}: Sym*, U: Sym):  
      (âˆ€ i. âˆ«{Î©} (L(U))*v{i} dx = âˆ«{Î©} f*v{i} dx) âˆ§ (U â‰ˆ âˆ‘{i} c{i}*v{i}) âŠ¢ 
        U satisfies L(U) = f
        
    theorem ExistUnique(L: PDE, f: Sym, g: BC, Î©: Domain):
      DirichletProblem(L, u, f, g) âŠ¢ âˆƒ! u. L(u) = f on Î©, u = g on âˆ‚Î©  
    {
      LocalExist {
        let U = âˆ‘{i} c{i}*v{i}  ; Galerkin approximation
        Galerkin(L, f, {v_i}, U)
        Approx(U, u, Î©, 1/n)
      }
      
      AssumeExist u, v  
        L(u) = f, u = g on âˆ‚Î©
        L(v) = f, v = g on âˆ‚Î©
      let w = u - v
      
      calc L(w) 
           = L(u - v)  
           = L(u) - L(v)  ; Linearity
           = f - f
           = 0
           
      calc w on âˆ‚Î©
           = u - v        
           = g - g
           = 0
           
      have L(w) = 0, w = 0 on âˆ‚Î©
      hence w = 0 by MaximumPrinciple
      hence u = v  
    }
    
    theorem Stability(L: PDE, u: Sym, f: Sym, g: BC, Î©: Domain):  
      DirichletProblem(L, u, f, g) âˆ§ (L is elliptic) âŠ¢ Stable(u, Î©)
    {
      assume L(u) = f on Î©
      assume u = g on âˆ‚Î©
      
      let L{Îµ}(v) = L(v + ÎµÎ·), Î· = D{Îµ}v  ; Linearize
      
      have L{Îµ}(u) = f + O(Îµ)   
      have L{Îµ}(u + Îµw) = f + O(Îµ)
        let z = (u + Îµw) - u = Îµw
        
      calc L{Îµ}(z)
           = L{Îµ}(Îµw) 
           = L{Îµ}(u + Îµw) - L{Îµ}(u)
           = O(Îµ)
           
      have z = 0 on âˆ‚Î©
      hence |z| â‰¤ C*Îµ on Î© by MaximumPrinciple
      hence |w| â‰¤ C on Î©
    }
    
    theorem Convergence(u: Sym -> Sym, f: Sym, Î©: Domain, L: PDE):
      (âˆ€ n. u{n} satisfies L(u{n}) = f) âˆ§ Stable(u{n}, Î©) âˆ§ Converge(u{n}, Î©) âŠ¢
        âˆƒ u*. L(u*) = f âˆ§ u{n} âŸ¶ u* on Î©
    {
      let e{n} = u* - u{n}, e{0} = u* - u{0}
      have L(e{n}) = L(u*) - L(u{n}) = f - f = 0
      
      calc |e{n+1}| 
           â‰¤ (1 - Ch)|e{n}|  ; Stability
           â‰¤ ... 
           â‰¤ (1 - Ch)^n |e{0}|
           âŸ¶ 0  ; Geometric series
           
      hence u{n} âŸ¶ u* on Î©
      have L(u*) = L(lim u{n}) = lim L(u{n}) = f  ; Continuity of L
    }
  }
}








CONCEPT PoissonExample {
  PROOFS {
    prove DirichletProblem(Î”u = f, u = 0 on âˆ‚Î©) on Î© = [0,1]Ã—[0,1]
    given:
      f: Sym, f = Î» x y. 2Ï€Â²*sin(Ï€x)*sin(Ï€y)  
      u*: Sym, u* = Î» x y. sin(Ï€x)*sin(Ï€y)   ; Exact solution
      {v_i}: Sym*, v_i = Î» x y. sin(iÏ€x)*sin(jÏ€y)  ; Basis functions
    {  
      let L = Î»u. -Î”u
      
      ; Verify the exact solution
      calc L(u*)
           = -Î”(Î» x y. sin(Ï€x)*sin(Ï€y))
           = -âˆ‚{xx}(sin(Ï€x)*sin(Ï€y)) - âˆ‚{yy}(sin(Ï€x)*sin(Ï€y))
           = -(Ï€Â²*sin(Ï€x)*sin(Ï€y) + Ï€Â²*sin(Ï€x)*sin(Ï€y))
           = -2Ï€Â²*sin(Ï€x)*sin(Ï€y)
           = f
      
      have u* = 0 on âˆ‚Î©  ; By inspection
      
      ; Galerkin approximation  
      let U = Î» x y. âˆ‘{i,j} c{ij}*sin(iÏ€x)*sin(jÏ€y)
        
      for i, j âˆˆ [1..N] {
        calc âˆ«{Î©} L(U)*v{ij} dx
             = âˆ«{0}^1 âˆ«{0}^1 (-Î”(âˆ‘{k,l} c{kl}*sin(kÏ€x)*sin(lÏ€y)))*sin(iÏ€x)*sin(jÏ€y) dx dy
             = âˆ‘{k,l} c{kl} âˆ«{0}^1 âˆ«{0}^1 (-Î”(sin(kÏ€x)*sin(lÏ€y)))*sin(iÏ€x)*sin(jÏ€y) dx dy
             = âˆ‘{k,l} c{kl} âˆ«{0}^1 âˆ«{0}^1 (kÂ²Ï€Â²+lÂ²Ï€Â²)*sin(kÏ€x)*sin(lÏ€y)*sin(iÏ€x)*sin(jÏ€y) dx dy
             = c{ij} âˆ«{0}^1 âˆ«{0}^1 (iÂ²Ï€Â²+jÂ²Ï€Â²)*sinÂ²(iÏ€x)*sinÂ²(jÏ€y) dx dy
             = c{ij} (iÂ²Ï€Â²+jÂ²Ï€Â²) / 4
             
        calc âˆ«{Î©} f*v{ij} dx  
             = âˆ«{0}^1 âˆ«{0}^1 2Ï€Â²*sin(Ï€x)*sin(Ï€y)*sin(iÏ€x)*sin(jÏ€y) dx dy
             = Î´{i1}*Î´{j1} Ï€Â² / 4   ; By orthogonality
      }
        
      hence âˆ€ i, j. c{ij} = Î´{i1}*Î´{j1}
      hence U = Î» x y. sin(Ï€x)*sin(Ï€y) = u*  
      
      ; Error estimate
      let e = u* - U
      
      have L(e) = L(u*) - L(U) = f - f = 0
      have e = 0 on âˆ‚Î©
      
      hence |e| â‰¤ C*||e||{LÂ²} on Î©  ; HÂ² regularity
      hence |e| â‰¤ C*hÂ²             ; LÂ² approximation
      hence ||u* - U||{HÂ¹} â‰¤ C*h   ; HÂ¹ approximation
    }
    conclude âˆƒ! u. Î”u = f on Î©, u = 0 on âˆ‚Î©
  }
}

In this example, we're proving the existence and uniqueness of the solution to the Dirichlet problem for the Poisson equation on the unit square Î© = [0,1]Ã—[0,1]. The PDE is Î”u = f with zero boundary conditions.
We start by specifying the right-hand side function f and the exact solution u* symbolically, using lambda expressions. We also define a set of basis functions {v_i} for the Galerkin approximation.
In the proof block, we first verify that the exact solution u* indeed satisfies the PDE and boundary conditions by symbolic calculation.
Next, we construct a Galerkin approximation U as a linear combination of the basis functions. We compute the Galerkin equations by integrating the PDE against each basis function. Using orthogonality of the basis, we find that the coefficients c_ij are zero except for c_11, implying that U equals the exact solution u*.
Finally, we estimate the error e = u* - U in various norms. Since the PDE is elliptic, we have HÂ² regularity, allowing us to bound the L^âˆ norm of the error by its LÂ² norm. The Galerkin method provides an LÂ² error estimate of order hÂ², where h is the mesh size. We conclude an HÂ¹ error estimate of order h.
The existence and uniqueness of the solution follow from the Lax-Milgram theorem for elliptic PDEs, which we invoke implicitly.





CONCEPT NavierStokesExample {
  PROOFS {
    prove ExistUnique(âˆ‚{t}v + (vâ€¢âˆ‡)v = -âˆ‡p + Î½*Î”v, divv = 0, v = 0 on âˆ‚Î©) 
    given:
      vâ‚€: Sym, vâ‚€ = Î» x y. (sin(Ï€x)*cos(Ï€y), -cos(Ï€x)*sin(Ï€y))  ; Initial velocity
      Î©: Domain, Î© = [0,1]Ã—[0,1]  ; Unit square
      Î½: â„, Î½ > 0  ; Viscosity
    {
      ; Function spaces  
      let ğ“¥ = HÂ¹â‚€(Î©)^2 âˆ© {v | divv = 0}  ; Velocity space
      let ğ“  = LÂ²â‚€(Î©)                     ; Pressure space
      
      ; Variational formulation
      let a(u, v) = Î½*âˆ«{Î©} âˆ‡u:âˆ‡v dx
      let b(v, q) = -âˆ«{Î©} q*divv dx
      let c(u, v, w) = âˆ«{Î©} (uâ€¢âˆ‡)vâ€¢w dx
      
      âˆ€ u, v, w âˆˆ ğ“¥ {
        have a(u, v) â‰¤ Î½*||âˆ‡u||*||âˆ‡v||              ; Cauchy-Schwarz
        have a(v, v) â‰¥ Î½*||âˆ‡v||Â²                    ; Coercivity
        have c(u, v, w) â‰¤ C*||âˆ‡u||*||âˆ‡v||*||âˆ‡w||   ; Sobolev embedding
        have c(u, v, v) = 0                          ; Skew-symmetry
      }
      
      âˆ€ v âˆˆ ğ“¥, q âˆˆ ğ“  {  
        have b(v, q) â‰¤ Î²*||v||*||q||   ; Bounded
        have âˆƒ v â‰  0. b(v, q) â‰¥ Î²*||v||*||q||  âˆ€q  ; Inf-sup condition
      }
      
      ; Galerkin approximation
      let ğ“¥_h âŠ‚ ğ“¥, dim ğ“¥_h = N  ; Finite element spaces
      let ğ“ _h âŠ‚ ğ“ , dim ğ“ _h = M
      
      find (v_h, p_h) âˆˆ C([0,T], ğ“¥_h) Ã— LÂ²([0,T], ğ“ _h):
        âˆ€ w_h âˆˆ ğ“¥_h, q_h âˆˆ ğ“ _h {
          (âˆ‚{t}v_h, w_h) + a(v_h, w_h) + c(v_h, v_h, w_h) + b(w_h, p_h) = 0
          b(v_h, q_h) = 0
          v_h(0) = vâ‚€_h  ; Projection of initial data
        }
        
      ; Energy estimates  
      choose w_h = v_h, q_h = p_h 
      
      calc (âˆ‚{t}v_h, v_h) + Î½*||âˆ‡v_h||Â² 
           = (âˆ‚{t}v_h, v_h) + a(v_h, v_h)
           = -(c(v_h, v_h, v_h) + b(v_h, p_h))
           = 0
           
      hence 1/2*âˆ‚{t}||v_h||Â² + Î½*||âˆ‡v_h||Â² â‰¤ 0
      hence ||v_h(t)||Â² + Î½*âˆ«{0}^t ||âˆ‡v_h(s)||Â² ds â‰¤ ||vâ‚€_h||Â²
      
      ; Compactness
      have v_h bounded in L^âˆ([0,T], ğ“¥)  ; By energy estimate
      have âˆ‚{t}v_h bounded in LÂ²([0,T], ğ“¥')  ; Dual estimate
      
      hence âˆƒ v âˆˆ L^âˆ([0,T], ğ“¥) âˆ© LÂ²([0,T], ğ“¥â‚‚). v_h â‡€ v
      have v_h â†’ v in LÂ²([0,T], ğ“¥)  ; Aubin-Lions lemma
      
      ; Pressure limit  
      âˆ€ q âˆˆ LÂ²([0,T], ğ“ ) {
        let q_h = P_h q  ; ğ“ _h-projection
        have b(v_h, q) = b(v_h, q - q_h)
                       â‰¤ ||v_h||*||q - q_h||
                       â‰¤ C*h*||v_h||*||q||  ; Approximation property
      }
       
      hence b(v, q) = 0 âˆ€ q  ; Inf-sup condition for limit
      hence âˆƒ p âˆˆ LÂ²([0,T], ğ“ ). divv = 0
      
      ; Nonlinear limit
      âˆ€ w âˆˆ Câ‚([0,T], ğ“¥) {
        calc lim âˆ«{0}^T c(v_h, v_h, w) dt
             = lim âˆ«{0}^T c(v_h - v, v_h, w) + c(v, v_h - v, w) + c(v, v, w) dt
             = âˆ«{0}^T c(v, v, w) dt  ; Strong convergence of v_h
      }
      
      ; Existence
      âˆ€ w âˆˆ Câ‚([0,T], ğ“¥), q âˆˆ LÂ²([0,T], ğ“ ) {
        have âˆ«{0}^T (âˆ‚{t}v, w) + a(v, w) + c(v, v, w) + b(w, p) dt = 0   
        have b(v, q) = 0
        have v(0) = vâ‚€
      }
      hence âˆƒ (v, p) solving Navier-Stokes
      
      ; Uniqueness
      assume âˆƒ (u, p), (v, q) solving Navier-Stokes
      let w = u - v
      
      calc âˆ«{0}^T (âˆ‚{t}w, w) + a(w, w) dt
           = -âˆ«{0}^T c(u, u, w) - c(v, v, w) dt  
           = -âˆ«{0}^T c(w, u, w) dt
           â‰¤ âˆ«{0}^T ||w||*||âˆ‡u||*||âˆ‡w|| dt
           â‰¤ âˆ«{0}^T (Î½/4*||âˆ‡w||Â² + C/Î½*||w||Â²*||âˆ‡u||Â²) dt
           
      hence âˆ‚{t}||w||Â² + Î½*||âˆ‡w||Â² â‰¤ C/Î½*||w||Â²*||âˆ‡u||Â²
      hence ||w(t)||Â² â‰¤ ||w(0)||Â² * exp(C/Î½*âˆ«{0}^t ||âˆ‡u||Â² ds) = 0
      hence w = 0, u = v
      
      ; Pressure uniqueness  
      have Î”(p - q) = 0   ; From momentum equation
      have âˆ‡(p - q)â€¢n = 0 on âˆ‚Î©  ; From boundary conditions
      hence p = q 
    }
    conclude âˆƒ! (v, p) solving Navier-Stokes
  }
}

This proof follows the standard Galerkin method approach for the Navier-Stokes equations. We start by defining the function spaces for velocity (ğ“¥) and pressure (ğ“ ), incorporating the divergence-free and boundary conditions.
Next, we introduce the variational formulation using the bilinear forms a (viscous term), b (pressure term), and the trilinear form c (convective term). We state their key properties like coercivity, boundedness, and inf-sup condition.
For the Galerkin approximation, we choose finite-dimensional subspaces ğ“¥_h and ğ“ _h and seek a discrete solution (v_h, p_h) satisfying the variational equations for all test functions (w_h, q_h).
We derive energy estimates by choosing special test functions, giving bounds on the velocity in terms of the initial data. These bounds provide compactness and allow us to pass to the limit in the linear terms.
The pressure limit is handled using the discrete inf-sup condition and approximation properties of the finite element spaces.
For the nonlinear term, we use the strong convergence of v_h in LÂ² to pass to the limit. This relies on the Aubin-Lions lemma for compactness.
Combining the limit equations, we obtain the existence of a weak solution (v, p).
Uniqueness follows from an energy argument applied to the difference of two solutions, making use of the skew-symmetry of the trilinear form c. Gronwall's inequality is used to conclude that the difference must be zero.
Pressure uniqueness is obtained from the uniqueness of the Neumann problem for the Laplace equation.
