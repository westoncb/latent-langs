CONCEPT QuantumThermodynamics {
  LANGUAGE {
    type Sys<S> = (State<S>, Dynamics<S>, Hilbert<S>)
    type State<S> = UnitVec(Hilbert<S>) 
    type Dynamics<S> = S -> S
    type Hilbert<S> = (Vec<S>, InnerProduct<S>)
    
    type Observable<S> = Herm(Hilbert<S>)
    
    func Entropy<S>(Ï: State<S>): â„
    func Hamiltonian<S>(s: Sys<S>): Observable<S>
    func Lindbladian<S>(s: Sys<S>): SuperOperator(Hilbert<S>)
    func ThermalState<S>(H: Observable<S>, T: â„â‰¥0): State<S>

    pred Entangled(Ïˆ: State<S âŠ— T>, Ï†: State<S>, Ï‡: State<T>)
    pred Separable(Ï: State<S âŠ— T>)

    notation "H(s)" = Hamiltonian(s)
    notation "L(s)" = Lindbladian(s)
    notation "Ï[H, T]" = ThermalState(H, T)
    notation "S(Ï)" = Entropy(Ï)
    notation "Ï ~ Sep" = Separable(Ï)
    notation "A âŠ— B" = TensorProduct(A, B)
    notation "tráµ¦[A]" = PartialTrace(A, B)

    infer ThermalEquilibrium<S>(s: Sys<S>, T: â„â‰¥0):
      s.State = Ï[H(s), T] âŸº L(s)|ÏâŸ© = 0

    infer Decoherence<S, E>(Ï: State<S âŠ— E>, H: Observable<S âŠ— E>, t: â„â‰¥0):
      (trâ‚‘[e^(-itH)Ïe^(itH)] ~ Sep) as t -> âˆ
      
    infer EntropyProductState<S, T>(Ï: State<S>, Ïƒ: State<T>): 
      S(Ï âŠ— Ïƒ) = S(Ï) + S(Ïƒ)
      
    infer SubadditivityEntropy<S, T>(Ï: State<S âŠ— T>):
      S(Ï) â‰¤ S(trâ‚›[Ï]) + S(trâ‚œ[Ï])
      
    rewrite VonNeumannEquation<S>(Ï: State<S>, H: Observable<S>):
      d/dt Ï(t) = -i[H, Ï(t)]
      
    rewrite LindbladEquation<S>(Ï: State<S>, L: SuperOperator(Hilbert<S>)):
      d/dt Ï(t) = L(Ï(t))
  }
  
  STRUCTURE {
    ; 2nd Law of Thermodynamics
    âˆ€(S: Type, s: Sys<S>). S(s.Dynamics(s.State)) â‰¥ S(s.State)
    
    ; Fundamental thermodynamic relation
    âˆ€(S: Type, s: Sys<S>, Ï: State<S>, T: â„â‰¥0).
      dS[Ï] = 1/T dE[Ï] - 1/T âŸ¨dH[s, Ï]âŸ©
      
    ; KMS condition for thermal equilibrium
    âˆ€(S: Type, s: Sys<S>, T: â„â‰¥0, t: â„‚, A: Obs<S>, B: Obs<S>).
      ThermalEquilibrium(s, T) âŸº âŸ¨A(t)BâŸ©_T = âŸ¨BA(t+iâ„/kT)âŸ©_T
      
    ; Entangled states not separable
    âˆ€(S, T: Type, Ïˆ: State<S âŠ— T>, Ï†: State<S>, Ï‡: State<T>).
      Entangled(Ïˆ, Ï†, Ï‡) âŸ¹ Â¬Separable(Ïˆ)
  }

  PROOFS {
    theorem Decoherence<S, E>: 
      âˆ€(Ï: State<S âŠ— E>, H: Observable<S âŠ— E>, t: â„â‰¥0).
        (trâ‚‘[e^(-itH)Ïe^(itH)] ~ Sep) as t -> âˆ
    {
      let U(t) = e^(-itH)
      let Ï(t) = U(t) Ï U(t)â€ 

      calc trâ‚‘[Ï(t)]
         = âˆ‘áµ¢â±¼â‚–â‚— âŸ¨eáµ¢|(Uâ‚œ âŠ— Id) (Ï âŠ— |eâ‚–âŸ©âŸ¨eâ‚—|) (Uâ‚œâ€  âŠ— Id)|eâ±¼âŸ© |eáµ¢âŸ©âŸ¨eâ±¼|  ; by matrix elements of partial trace
         = âˆ‘áµ¢â±¼â‚–â‚— âŸ¨eáµ¢|Uâ‚œ|Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—|Ï|Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—|Uâ‚œâ€ |eâ±¼âŸ© |eáµ¢âŸ©âŸ¨eâ±¼|   ; with |Ïˆâ‚–â‚—âŸ© = (Id âŠ— âŸ¨eâ‚—|)|ÏˆâŸ©
         = âˆ‘â‚–â‚— pâ‚–â‚— âˆ‘áµ¢â±¼ âŸ¨eáµ¢|Uâ‚œ|Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—|Uâ‚œâ€ |eâ±¼âŸ© |eáµ¢âŸ©âŸ¨eâ±¼|   ; with pâ‚–â‚— = âŸ¨Ïˆâ‚–â‚—|Ï|Ïˆâ‚–â‚—âŸ©
         = âˆ‘â‚–â‚— pâ‚–â‚— Ïƒâ‚–â‚—(t)   ; with Ïƒâ‚–â‚—(t) = Uâ‚œ|Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—|Uâ‚œâ€ 
         
      Ïƒâ‚–â‚—(t) -> |Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—| as t -> âˆ   ; by dephasing in energy eigenbasis {|Ïˆâ‚–â‚—âŸ©}
      
      hence trâ‚‘[Ï(t)] -> âˆ‘â‚–â‚— pâ‚–â‚— |Ïˆâ‚–â‚—âŸ©âŸ¨Ïˆâ‚–â‚—| ~ Sep as t -> âˆ
    }

    theorem Subadditivity<S, T>:
      âˆ€(Ï: State<S âŠ— T>). S(Ï) â‰¤ S(trâ‚›[Ï]) + S(trâ‚œ[Ï])
    {
      let H(p) = -âˆ‘áµ¢ páµ¢ log(páµ¢) be the Shannon entropy of the distribution p 

      S(trâ‚›[Ï]) = H(Spec(trâ‚›[Ï]))   ; definition of von Neumann entropy
      S(trâ‚œ[Ï]) = H(Spec(trâ‚œ[Ï]))

      calc S(Ï)
         = H(Spec(Ï))
         â‰¤ H(Spec(trâ‚›[Ï]) Ã— Spec(trâ‚œ[Ï]))   ; joint entropy â‰¤ product of marginals
         = H(Spec(trâ‚›[Ï])) + H(Spec(trâ‚œ[Ï]))   ; Shannon entropy of product
         = S(trâ‚›[Ï]) + S(trâ‚œ[Ï])
    }
    
    theorem QuantumZeroLaw<S>: 
      âˆ€(sâ‚: Sys<S>, sâ‚‚: Sys<S>, T: â„â‰¥0). 
        ThermalEquilibrium(sâ‚, T) âˆ§ ThermalEquilibrium(sâ‚‚, T) âŠ¢ 
          ThermalEquilibrium(TensorProduct(sâ‚, sâ‚‚), T)
    {
      assume ThermalEquilibrium(sâ‚, T) âˆ§ ThermalEquilibrium(sâ‚‚, T)

      sâ‚.State = Ï[H(sâ‚), T]   ; by definition
      sâ‚‚.State = Ï[H(sâ‚‚), T]

      TensorProduct(sâ‚, sâ‚‚).State 
        = sâ‚.State âŠ— sâ‚‚.State
        = Ï[H(sâ‚), T] âŠ— Ï[H(sâ‚‚), T]
        = Ï[H(sâ‚) âŠ— ğŸ™â‚‚ + ğŸ™â‚ âŠ— H(sâ‚‚), T]   ; by tensor product of observables
        = Ï[H(TensorProduct(sâ‚, sâ‚‚)), T]   ; by definition of composite system
        
      hence ThermalEquilibrium(TensorProduct(sâ‚, sâ‚‚), T)   ; by definition
    }

    theorem QuantumEntropyProduct<S, T>:
      âˆ€(Ï: State<S>, Ïƒ: State<T>). S(Ï âŠ— Ïƒ) = S(Ï) + S(Ïƒ)
    {
      calc S(Ï âŠ— Ïƒ)
        = -tr((Ï âŠ— Ïƒ) log(Ï âŠ— Ïƒ))   ; definition of von Neumann entropy
        = -tr((Ï log Ï) âŠ— (Ïƒ log Ïƒ))   ; logarithm of tensor product
        = -tr(Ï log Ï) tr(Ïƒ log Ïƒ)   ; trace of tensor product  
        = S(Ï) + S(Ïƒ)   ; definition of von Neumann entropy
    }
  } 
}

This Concept, named QuantumThermodynamics, combines ideas from quantum mechanics, thermodynamics, and information theory. It defines a quantum system as a triplet of state, dynamics, and Hilbert space, akin to the classical definition in FunctionalThermodynamics. Observables are Hermitian operators on the Hilbert space.
Key concepts include entropy, Hamiltonian, thermal state, entanglement, and separability. Inferential rules specify conditions for thermal equilibrium, decoherence of entangled states, entropy of product states, and subadditivity of entropy. Rewrite rules give the von Neumann equation for unitary evolution and the Lindblad equation for open system dynamics.
The structural axioms assert the 2nd law, the fundamental thermodynamic relation, the KMS condition for equilibrium, and the non-separability of entangled states.
Theorems prove decoherence as the approach to a separable state, subadditivity of entropy, the zeroth law of thermodynamics for composite quantum systems, and the additivity of entropy for product states.
The Concept makes heavy use of tensor product structure to discuss composite systems and partial trace to extract subsystem states.